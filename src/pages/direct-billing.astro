---
import BaseLayout from 'src/layouts/BaseLayout.astro';
import Landing from '@components/Landing.astro';
import allLogos from '@assets/images/all-logos.avif';
import faqImg from '@assets/images/stack-stones.jpeg';

// Optimize our landing image and pass it as props to the BaseLayout (for preloading) and Landing (for rendering)
import { getOptimizedImage } from '@js/utils';
import landingImage from '@assets/images/stone-massage-background1.png'; // <-- THE PATH TO THE ASSET YOU WANT TO PRELOAD - The asset must live in src
import { Image, Picture } from 'astro:assets';
import FAQ from '@components/FAQ.astro';

const faqs = [
  {
    question: 'Do you offer direct billing to insurance?',
    answer:
      'Yes, we provide direct billing to most major insurance providers. Contact us to confirm if your provider is covered.',
  },
  {
    question: 'What types of massage do you offer?',
    answer:
      'We specialize in therapeutic massage, including deep tissue, Swedish, hot stone, relaxation, and prenatal massage.',
  },
  {
    question: 'How should I prepare for my first massage?',
    answer:
      'Arrive 10â€“15 minutes early to complete intake forms and discuss your goals with your RMT. Wear comfortable clothing and be ready to relax.',
  },
  {
    question: 'Do I need a doctorâ€™s referral for massage therapy?',
    answer:
      'A doctorâ€™s referral is usually not required. However, some insurance plans may request oneâ€”check with your provider.',
  },
  {
    question: 'What is your cancellation policy?',
    answer:
      'We require at least 24 hoursâ€™ notice for cancellations or rescheduling. Missed appointments may be subject to a fee.',
  },
];

const optimizedImage = await getOptimizedImage(landingImage);
---

<BaseLayout preloadedImage={optimizedImage}>
  <section class="bg-orange-50" id="direct-billing">
    <div class="mx-auto max-w-6xl px-6 py-16 md:py-20">
      <!-- Header -->
      <header class="text-center max-w-3xl mx-auto">
        <h2 class="font-serif text-3xl md:text-4xl text-gray-900">
          Direct Billing
        </h2>
        <p class="mt-3 text-emerald-900 font-semibold">
          We offer direct billing to leading insurance providers in Canada.
        </p>
        <p class="mt-4 text-gray-700 leading-7">
          At Kabayan Healing Touch Massage, we submit claims directly to your
          insurerâ€”so you can focus on rest and recovery. Whether youâ€™re covered
          by private insurance or being treated after an accident (MVA), weâ€™ll
          help simplify the process.
        </p>
      </header>

      <!-- Content -->
      <div
        id="content-container"
        class="mt-10 mx-auto max-w-3xl lg:max-w-6xl flex flex-col gap-6 lg:flex-row lg:items-stretch"
      >
        <!-- Left: Panel -->
        <div
          id="left-card"
          class="place-content-center rounded-xl p-6 ring-1 ring-black/5 lg:w-[44%] lg:shrink-0 lg:p-8"
        >
          <h3 class="font-serif text-2xl md:text-3xl">
            ðŸ“Œ How Direct Billing Works
          </h3>
          <p class="mt-3">
            Fast, simple, and hassleâ€‘freeâ€”so you can leave feeling your best.
          </p>
        </div>

        <!-- Right: Steps -->
        <div
          id="right-card"
          class="rounded-xl bg-white/90 p-6 ring-1 ring-black/10 lg:flex-1 lg:p-8"
        >
          <ol class="space-y-5 text-gray-900">
            <li class="flex gap-3">
              <span
                class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bullet text-white text-xs"
                >1</span
              >
              <span>Book your appointment (Inâ€‘Clinic or Mobile Massage).</span>
            </li>
            <li class="flex gap-3">
              <span
                class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bullet text-white text-xs"
                >2</span
              >
              <span>Provide your insurance details when you arrive.</span>
            </li>
            <li class="flex gap-3">
              <span
                class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bullet text-white text-xs"
                >3</span
              >
              <span>We submit the claim directly to your provider.</span>
            </li>
            <li class="flex gap-3">
              <span
                class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bullet text-white text-xs"
                >4</span
              >
              <span>You only pay any remaining balance, if applicable.</span>
            </li>
          </ol>

          <div class="mt-8 flex justify-center">
            <a
              href="https://www.facebook.com/share/1GHhcVU8FS/?mibextid=wwXIfr"
              target="_blank"
              class="inline-flex items-center rounded-full px-6 py-3 text-sm font-semibold transition-colors"
            >
              Book Appointment
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- We are pleased to offer direct billing for these providers -->
  <section class="">
    <div class="">
      <h3
        id="banner"
        class="py-12 md:py-16 text-center font-serif text-xl md:text-2xl lg:text-3xl"
      >
        We are pleased to offer direct billing for these providers:
      </h3>

      <div class="mt-8 max-w-6xl px-6 mx-auto">
        <Image
          src={allLogos}
          alt="Logos of insurance providers we can direct bill"
          widths={[640, 960, 1280, 1600, 1920]}
          sizes="(min-width: 1280px) 1100px, (min-width: 768px) 90vw, 100vw"
          format="avif"
          class="mx-auto h-auto w-full max-w-5xl"
          loading="lazy"
          decoding="async"
        />
      </div>
    </div>
  </section>

  <!-- ============================================ -->
  <!--                     CTA                      -->
  <!-- ============================================ -->

  <section id="cta-697">
    <div class="cs-container">
      <div class="cs-content">
        <h2 class="cs-title">
          We also support less common insurance providers. Contact us to verify
          if your plan qualifies for direct billing.
        </h2>
        <a href="/contact" class="cs-button-solid">Contact Us</a>
      </div>
    </div>
    <!--SVG Waves Background-->
    <img
      class="cs-background"
      src="https://csimg.nyc3.cdn.digitaloceanspaces.com/Images%2FGraphics%2Fwaves-3.svg"
      alt="wave graphic"
      width="1920"
      height="318"
      loading="lazy"
      decoding="async"
      aria-hidden="true"
    />
  </section>

  <!-- ============================================ -->
  <!--                     FAQ                      -->
  <!-- ============================================ -->

  <section id="faq-1193">
    <div class="cs-container">
      <div class="cs-image-group">
        <Picture
          pictureAttributes={{ class: 'cs-picture cs-picture1' }}
          src={faqImg}
          formats={['avif', 'webp']}
          alt="stacked stones for massage"
        />
      </div>
      <div class="cs-content">
        <span class="cs-topper">Asked questions</span>
        <h2 class="cs-title">Frequently Asked Questions</h2>
        <ul class="cs-faq-group">
          {
            faqs.map((faq, index) => (
              <li class={`cs-faq-item ${index === 0 ? 'active' : ''}`}>
                <button class="cs-button">
                  <span class="cs-button-text">{faq.question}</span>
                </button>
                <p class="cs-item-p">{faq.answer}</p>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </section>

  <!-- FAQ Scripts -->
  <script>
    const faqItems = Array.from(document.querySelectorAll('.cs-faq-item'));
    for (const item of faqItems) {
      const onClick = () => {
        item.classList.toggle('active');
      };
      item.addEventListener('click', onClick);
    }
  </script>

  <!-- <FAQ /> -->
</BaseLayout>

<style lang="less">
  // direct billing
  @media only screen and (min-width: 0em) {
    #direct-billing {
      #content-container {
        #left-card {
          background-color: var(--primaryLight);
          h3 {
            color: #fff !important;
          }
          p {
            color: #eee !important;
          }
        }
        #right-card {
          .bullet {
            background-color: #c35858;
          }
          a {
            background-color: var(--primary);
            color: #fff !important;
            &:hover {
              background-color: #000 !important;
            }
          }
        }
      }
    }

    //banner
    #banner {
      background-color: var(--primary);
      color: #fff !important;
    }
  }

  /*-- -------------------------- -->
<---            CTA             -->
<--- -------------------------- -*/

  /* Mobile - 360px */
  @media only screen and (min-width: 0rem) {
    #cta-697 {
      padding: 3rem;
      background-color: var(--primary);
      position: relative;
      z-index: 1;

      .cs-container {
        width: 100%;
        max-width: (1280/16rem);
        margin: auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        /* 48px - 64px */
        gap: clamp(3rem, 6vw, 4rem);
      }

      .cs-content {
        /* set text align to left if content needs to be left aligned */
        text-align: center;
        width: 100%;
        display: flex;
        flex-direction: column;
        /* centers content horizontally, set to flex-start to left align */
        align-items: center;
        /* 48px - 64px */
        gap: clamp(3rem, 6vw, 4rem);
      }

      .cs-title {
        font-size: 2rem !important;
        color: var(--bodyTextColorWhite);
      }

      .cs-button-solid {
        font-size: (16/16rem);
        /* 46px - 56px */
        line-height: clamp(2.875rem, 5.5vw, 3.5rem);
        text-decoration: none;
        font-weight: 700;
        text-align: center;
        margin: 0;
        color: #000;
        min-width: (150/16rem);
        padding: 0 (24/16rem);
        background-color: var(--secondary);
        border-radius: (4/16rem);
        display: inline-block;
        position: relative;
        z-index: 1;
        /* prevents padding from adding to the width */
        box-sizing: border-box;

        &:before {
          content: '';
          position: absolute;
          height: 100%;
          width: 0%;
          background: #000;
          opacity: 1;
          top: 0;
          left: 0;
          z-index: -1;
          border-radius: (4/16rem);
          transition: width 0.3s;
        }

        &:hover {
          color: #fff;
          &:before {
            width: 100%;
          }
        }
      }

      .cs-background {
        width: 100%;
        height: 100%;
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
        /* makes it act like a background image */
        object-fit: cover;
      }
    }
  }

  /* Small Desktop - 1024px */
  @media only screen and (min-width: 64rem) {
    #cta-697 {
      .cs-content {
        text-align: left;
        flex-direction: row;
        justify-content: space-between;
      }
    }
  }

  // Services
  @media only screen and (min-width: 0rem) {
    #services {
      #services-content {
        background-color: var(--primary) !important;
        h3 {
          color: #fff !important;
        }
        p {
          color: #ddd !important;
        }
        a {
          background-color: var(--secondary) !important;
        }
      }
    }
  }

  /*-- -------------------------- -->
<---            FAQ             -->
<--- -------------------------- -*/

  /* Mobile - 360px */
  @media only screen and (min-width: 0rem) {
    #faq-1193 {
      padding: var(--sectionPadding);
      position: relative;
      overflow: hidden;

      .cs-container {
        width: 100%;
        /* chnages to 1280px at desktop */
        max-width: (584/16rem);
        margin: auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        /* 40px - 48px */
        gap: clamp(2.5rem, 5vw, 3rem);
      }

      .cs-content {
        text-align: left;
        max-width: (630/16rem);
      }

      .cs-title {
        /* 20 characters wide including spaces */
        max-width: 20ch;
        margin: 0 0 (32/16rem) 0;
      }

      .cs-faq-group {
        padding: 0;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: (16/16rem);
      }

      .cs-faq-item {
        list-style: none;
        width: 100%;
        background-color: #f7f7f7;
        padding: (20/16rem);
        box-sizing: border-box;
        transition: border-bottom 0.3s;

        &.active {
          border-color: var(--primaryLight);
          .cs-button {
            color: var(--primary);
            &:before {
              background-color: var(--primaryLight);
              transform: rotate(315deg);
            }
            &:after {
              background-color: var(--primaryLight);
              transform: rotate(-315deg);
            }
          }
          .cs-item-p {
            height: auto;
            padding-top: (16/16rem);
            opacity: 1;
          }
        }
      }

      .cs-button {
        /* 16px - 20px */
        font-size: clamp(1rem, 2vw, 1.25rem);
        line-height: 1.2em;
        text-align: left;
        font-weight: bold;
        padding: 0;
        border: none;
        background: transparent;
        color: var(--headerColor);
        display: block;
        width: 100%;
        position: relative;
        transition:
          background-color 0.3s,
          color 0.3s;

        &:hover {
          cursor: pointer;
        }

        &:before {
          /* left line */
          content: '';
          width: (8/16rem);
          height: (2/16rem);
          background-color: var(--headerColor);
          opacity: 1;
          border-radius: 50%;
          position: absolute;
          display: block;
          top: 45%;
          right: (4/16rem);
          transform: rotate(45deg);
          /* animate the transform from the left side of the x axis, and the center of the y */
          transform-origin: left center;
          transition: transform 0.5s;
        }

        &:after {
          /* right line */
          content: '';
          width: (8/16rem);
          height: (2/16rem);
          background-color: var(--headerColor);
          opacity: 1;
          border-radius: 50%;
          position: absolute;
          display: block;
          top: 45%;
          right: (1/16rem);
          transform: rotate(-45deg);
          /* animate the transform from the right side of the x axis, and the center of the y */
          transform-origin: right center;
          transition: transform 0.5s;
        }
      }

      .cs-button-text {
        width: 90%;
        display: block;
      }

      .cs-item-p {
        /* 14px - 16px */
        font-size: clamp(0.875rem, 1.5vw, 1rem);
        line-height: 1.5em;
        width: 90%;
        max-width: (541/16rem);
        height: 0;
        margin: 0;
        padding: 0;
        opacity: 0;
        color: var(--bodyTextColor);
        /* clips the text so it doesn't show up */
        overflow: hidden;
        transition:
          opacity 0.3s,
          padding-bottom 0.3s;
      }

      .cs-image-group {
        /* we use ems for everything in the container so they pull their value for em from the font size of this parent instead of the root element (html). This font size scales with the view width of the screen and stops when the font size equals the value of 1em (16px) and stops growing */
        font-size: ~'min(2.43vw, 1em)';
        width: (598/16em);
        height: (678/16em);
        display: block;
        position: relative;
      }

      .cs-picture {
        display: block;
        position: absolute;
        z-index: 1;
      }

      .cs-picture1 {
        width: (522/16em);
        height: (609/16em);
        top: 0;
        left: 0;

        img {
          position: absolute;
          top: 0;
          left: 0;
          height: 100%;
          width: 100%;
          object-fit: cover;
        }
      }

      .cs-picture2 {
        width: (400/16em);
        height: (650/16em);
        display: flex;
        align-items: flex-end;
        justify-content: flex-end;
        bottom: 0;
        right: 0;

        img {
          width: auto;
          height: 100%;
          max-height: (650/16rem);
          object-fit: contain;
        }
      }
    }
  }

  /* Desktop - 1024px */
  @media only screen and (min-width: 64rem) {
    #faq-1193 {
      .cs-container {
        max-width: (1280/16rem);
        flex-direction: row;
        justify-content: space-between;
        align-items: stretch;
      }

      .cs-content {
        width: 55%;
      }

      .cs-image-group {
        font-size: ~'min(1.4vw, 1em)';
        height: auto;
        min-height: (678/16rem);
      }

      .cs-picture1 {
        height: 90%;
      }
    }
  }

  /*-- -------------------------- -->
  <---          Reviews           -->
  <--- -------------------------- --*/

  /* Mobile - 360px */
  @media only screen and (min-width: 0em) {
    #reviews {
      /* Centers the button */
      text-align: center;
      padding: var(--sectionPadding);

      .cs-container {
        width: 100%;
        max-width: (1104/16rem);
        margin: auto;
      }

      .cs-topper {
        text-align: center;
        margin-bottom: (16/16rem);
      }

      .cs-title {
        text-align: center;
        max-width: (700/16rem);
      }

      .cs-text {
        text-align: center;
        max-width: (650/16rem);
        /* 88px - 104px */
        margin-bottom: clamp(5.5em, 10.2vw, 6.5em);
      }

      .cs-card-group {
        /* 48px - 64px */
        margin: 0 auto clamp(3rem, 5vw, 4rem);
        padding: 0;
      }

      .cs-item {
        text-align: left;
        list-style: none;
        width: 100%;
        max-width: (542/16rem);
        margin: 0 auto (64/16rem);
        /* Prevents padding from affecting height & width */
        box-sizing: border-box;
        /* Padding L & R - 16px - 32px */
        padding: (60/16rem) clamp(1rem, 3.2vw, 2rem) 0;
        /* 32px - 40px */
        padding-bottom: clamp(2rem, 5.4vw, 2.5rem);
        background: #fff;
        box-shadow: 0px 20px 39px 0px rgba(0, 0, 0, 0.05);
        border-radius: (4/16rem);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        position: relative;

        &:last-of-type {
          margin-bottom: 0;
        }
      }

      .cs-item-img {
        width: (80/16rem);
        height: (80/16rem);
        position: absolute;
        top: (-40/16rem);
      }

      .cs-item-p {
        font-size: (16/16rem);
        line-height: 1.5em;
        margin: 0 0 (20/16rem);
        padding-bottom: (20/16rem);
        color: var(--bodyTextColor);
        border-bottom: 1px solid #e8e9ec;
      }

      .cs-reviewer {
        font-size: (16/16rem);
        font-weight: 700;
        line-height: 1.5em;
        width: 40%;
        margin: 0 auto 0 0;
        color: var(--headerColor);
        display: block;
      }

      .cs-desc {
        font-size: (14/16rem);
        font-weight: 400;
        color: var(#353535);
        display: block;
      }

      .cs-item-stars {
        width: (96/16rem);
        height: (16/16rem);
      }
    }
  }

  /* Tablet - 768px */
  @media only screen and (min-width: 48em) {
    #reviews {
      .cs-card-group {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: (16/16rem);
      }

      .cs-item {
        /* reset margin so it won't interfere with flexbox */
        margin: 0;
      }
    }
  }

  /* Dark Mode */
  @media only screen and (min-width: 0em) {
    body.dark-mode {
      #reviews {
        .cs-title,
        .cs-text,
        .cs-item-p,
        .cs-reviewer {
          color: var(--bodyTextColorWhite);
        }

        .cs-item {
          background: var(--medium);
        }

        .cs-desc {
          color: var(--primaryLight);
        }
      }
    }
  }
</style>
