---
import BaseLayout from 'src/layouts/BaseLayout.astro';
import landingImage from '@assets/images/landing.jpg'; // <-- THE PATH TO THE ASSET YOU WANT TO PRELOAD - The asset must live in src
import { getCollection } from 'astro:content';

// Use your best deep‑tissue hero image here
import services1Img from '@assets/images/Services-1.TherapeuticMassage.jpg';
import type { HeroServiceProps } from '@components/Services/ServiceHero.astro';
import { getOptimizedImage } from '@js/utils';
import ServiceHero from '@components/Services/ServiceHero.astro';
import type {
  PriceBenefitsProps,
  ServiceBenefit,
  ServicePriceRow,
} from '@components/Services/PriceBenifits.astro';
import PriceBenifits from '@components/Services/PriceBenifits.astro';

const optimizedImage = await getOptimizedImage(landingImage);

export async function getStaticPaths() {
  const services = await getCollection('services');

  return services.map((entry) => ({
    params: { service: entry.id },
    props: { service: entry },
  }));
}

const { service } = Astro.props;

const data = service.data;

const highlights = data.hightlights.map((h) => ({
  title: h.featName,
  body: h.featBody,
}));

const heroData: HeroServiceProps = {
  title: data.title,
  image: data.image,
  alt: data.imageAlt,
  subtitle: data.subtitle,
  highlights,
  ctaPrimary: { label: 'Book A Massage', href: '/booking' },
  ctaSecondary: { label: 'Ask About Session Options', href: '/contact' },
};

const benefits = data.benefits.map((b, i) => ({
  num: `0${i + 1}`,
  title: b.benefitName,
  body: b.benefitBody,
}));

const benefitsData: PriceBenefitsProps = {
  benefitsTitle: data.benefitsTitle,
  benefits,
  benefitsTagline: data.benefitsTagline,
  prices: data.prices ?? [],
  ctaLabel: 'Book A Massage Session',
};
---

<BaseLayout
  title="Services"
  description="Kabayan Healing Touch Massage - Professional Massage Therapy"
  preloadedImage={optimizedImage}
>
  <ServiceHero {...heroData} />
  <!-- <PriceBenifits {...benefitsData} /> -->
</BaseLayout>
